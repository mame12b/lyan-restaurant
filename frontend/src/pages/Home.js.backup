import React, { useState, useEffect } from 'react';
import {
  Avatar,
  Box,
  Button,
  Container,
  Grid,
  Paper,
  Stack,
  Typography,
  alpha,
  useTheme
} from '@mui/material';
import { Link } from 'react-router-dom';
import { motion } from 'framer-motion';
import useMediaQuery from '@mui/material/useMediaQuery';
import { packageAPI } from '../services/api';
import CelebrationIcon from '@mui/icons-material/Celebration';
import RestaurantIcon from '@mui/icons-material/Restaurant';
import CameraAltIcon from '@mui/icons-material/CameraAlt';
import BungalowIcon from '@mui/icons-material/Bungalow';
import ArrowForwardIcon from '@mui/icons-material/ArrowForward';
import StarIcon from '@mui/icons-material/Star';

// Use a WebP, lower-resolution variant to reduce payload for first paint
const heroImage = 'https://images.unsplash.com/photo-1514525253161-7a46d19cd819?auto=format&fit=crop&w=1200&q=60&fm=webp';


const serviceHighlights = [
  {
    title: 'Culinary Excellence',
    description: 'Award-winning chefs blending Ethiopian flavors with global gastronomy.',
    icon: <RestaurantIcon fontSize="large" />,
    color: '#078930'
  },
  {
    title: 'Event Design',
    description: 'Immersive environments and decor tailored to your vision.',
    icon: <CelebrationIcon fontSize="large" />,
    color: '#D4AF37'
  },
  {
    title: 'Photography',
    description: 'Professional photography and videography to capture every moment.',
    icon: <CameraAltIcon fontSize="large" />,
    color: '#DA121A'
  },
  {
    title: 'Premium Venues',
    description: 'Exclusive partnerships with iconic venues across Addis Ababa.',
    icon: <BungalowIcon fontSize="large" />,
    color: '#0F5B4F'
  }
];

const testimonials = [
  {
    name: 'Amanuel & Liya',
    title: 'Wedding',
    quote: 'Every detail was perfectly executed. The team made our wedding day absolutely unforgettable!',
    avatar: 'https://images.unsplash.com/photo-1524504388940-b1c1722653e1?auto=format&fit=crop&w=200&q=80',
    rating: 5
  },
  {
    name: 'Yared T.',
    title: 'Corporate Event',
    quote: 'Professional, organized, and flawless execution. Our stakeholders were thoroughly impressed.',
    avatar: 'https://images.unsplash.com/photo-1521572267360-ee0c2909d518?auto=format&fit=crop&w=200&q=80',
    rating: 5
  },
  {
    name: 'Bethlehem S.',
    title: 'Birthday Celebration',
    quote: 'They transformed my birthday into a magical experience. Guests are still talking about it!',
    avatar: 'https://images.unsplash.com/photo-1544723795-3fb6469f5b39?auto=format&fit=crop&w=200&q=80',
    rating: 5
  }
];

const stats = [
  { value: '500+', label: 'Celebrations orchestrated' },
  { value: '200+', label: 'Corporate partners' },
  { value: '50K+', label: 'Guests served' }
];

const buildSrcSet = (url, widths = [480, 768, 1200]) =>
  widths
    .map((width) => `${url.replace(/w=\d+/g, `w=${width}`)} ${width}w`)
    .join(', ');

const shrinkLabel = { shrink: true };
const dialogPaperProps = {
  sx: { 
    bgcolor: '#f8f9fa'
  }
};

const initialBookingState = {
  name: '',
  phoneNumber: '',
  eventDate: '',
  guests: '',
  location: '',
  notes: ''
};

const Home = () => {
  const [featuredPackages, setFeaturedPackages] = useState([]);
  const [selectedPackage, setSelectedPackage] = useState(null);
  const [detailsOpen, setDetailsOpen] = useState(false);
  
  const [bookingData, setBookingData] = useState(initialBookingState);
  const [bookingLoading, setBookingLoading] = useState(false);
  const [successDialogOpen, setSuccessDialogOpen] = useState(false);
  const [autoResponseMessage, setAutoResponseMessage] = useState('');
  const [successPlatform, setSuccessPlatform] = useState('whatsapp');
  const [telegramLink, setTelegramLink] = useState('');

  const handleBookingChange = (e) => {
    setBookingData({ ...bookingData, [e.target.name]: e.target.value });
  };

  const handleCloseDetails = () => {
    setDetailsOpen(false);
    setBookingData(initialBookingState);
  };

  const formatBookingDate = (value) => {
    if (!value) return 'Not set';
    try {
      const date = new Date(`${value}T00:00:00`);
      return new Intl.DateTimeFormat('en-GB', {
        day: 'numeric', month: 'short', year: 'numeric'
      }).format(date);
    } catch (error) {
      return value;
    }
  };

  const formatPrice = (price) => {
    const numeric = Number(price);
    if (!Number.isFinite(numeric)) return '‚Äî';
    return `${new Intl.NumberFormat('en-ET').format(numeric)} ·â•·à≠`;
  };

  const handleSendWhatsApp = () => {
    sendBookingInquiry('whatsapp');
  };

  const handleSendTelegram = () => {
    sendBookingInquiry('telegram');
  };

  const sendBookingInquiry = async (platform) => {
    if (!selectedPackage) return;

    const name = bookingData.name.trim();
    if (!name) {
      toast.error('Please share your name so we can personalise our reply.');
      return;
    }

    const phoneNumber = bookingData.phoneNumber.trim();
    if (!phoneNumber) {
      toast.error('Please share your phone number so we can contact you.');
      return;
    }

    if (!bookingData.eventDate) {
      toast.error('Please choose your preferred event date.');
      return;
    }

    const friendlyDate = formatBookingDate(bookingData.eventDate);
    const guests = bookingData.guests ? bookingData.guests.toString().trim() : '';
    const location = bookingData.location ? bookingData.location.trim() : '';
    const notes = bookingData.notes ? bookingData.notes.trim() : '';
    
    const finalPrice = selectedPackage.discountedPrice || selectedPackage.price;
    const categoryLabel = selectedPackage.category || 'Custom';
    const priceLabel = formatPrice(finalPrice);
    const basePriceLabel = selectedPackage.discountedPrice ? formatPrice(selectedPackage.price) : null;

    if (platform === 'telegram') {
      try {
        setBookingLoading(true);
        const response = await inquiryAPI.create({
          name,
          phoneNumber,
          eventDate: bookingData.eventDate,
          guests: bookingData.guests,
          location: bookingData.location,
          notes: bookingData.notes,
          packageId: selectedPackage._id
        });

        if (response && response.success) {
          const inquiryId = response.data._id;
          const tLink = `https://t.me/LyanEventsBot?start=inquiry_${inquiryId}`;
          setTelegramLink(tLink);
          setSuccessPlatform('telegram');
          setSuccessDialogOpen(true);
          handleCloseDetails();
          return;
        } else {
          toast.error('Could not create booking inquiry. Please try again.');
          return;
        }
      } catch (error) {
        console.error('Failed to create inquiry:', error);
        toast.error('Something went wrong. Please try again.');
        return;
      } finally {
        setBookingLoading(false);
      }
    }

    const message = `‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
   üéâ *LYAN RESTAURANT* üéâ
   New Booking Inquiry
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

Hello LYAN Team! üëã

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üë§ *CUSTOMER INFORMATION*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìù Name: *${name}*
üìû Phone: *${phoneNumber}*

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üì¶ *PACKAGE SELECTED*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚ú® *${selectedPackage.name}*
üéØ Category: *${categoryLabel.charAt(0).toUpperCase() + categoryLabel.slice(1)}*
üí∞ Price: *${priceLabel}*${basePriceLabel ? `\n~~${basePriceLabel}~~` : ''}${selectedPackage.maxGuests ? `\nüë• Capacity: *${selectedPackage.maxGuests} guests*` : ''}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìÖ *EVENT DETAILS*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìÜ Date: *${friendlyDate}*${guests ? `\nüë• Expected Guests: *${guests}*` : ''}${location ? `\nüìç Location: *${location}*` : ''}${notes ? `\n\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\nüìù *SPECIAL REQUESTS*\n‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ\n${notes}` : ''}

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ

*Could you guide me through the next steps?*

Thank you! üôè`;

    const encodedMessage = encodeURIComponent(message);
    
    if (platform === 'whatsapp') {
      try {
        await inquiryAPI.create({
          name,
          phoneNumber,
          eventDate: bookingData.eventDate,
          guests: bookingData.guests,
          location: bookingData.location,
          notes: bookingData.notes,
          packageId: selectedPackage._id
        });
      } catch (error) {
        console.error('Failed to save WhatsApp inquiry to DB:', error);
      }

      window.open(`https://wa.me/+971563561803?text=${encodedMessage}`, '_blank');
      toast.success('WhatsApp opened! Send the message to continue.');
      
      // Generate auto-response
      const autoResponse = `‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
   üéâ *LYAN RESTAURANT* üéâ
   Booking Confirmation
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

Dear *${name}*,

‚úÖ *Thank you for your inquiry!*

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìã *YOUR REQUEST SUMMARY*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üì¶ Package: *${selectedPackage.name}*
üìÜ Date: *${friendlyDate}*${guests ? `\nüë• Guests: *${guests}*` : ''}${location ? `\nüìç Location: *${location}*` : ''}
üí∞ Price: *${priceLabel}*

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìû *NEXT STEPS*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
1Ô∏è‚É£ Our team will contact you within 24 hours
2Ô∏è‚É£ We'll confirm all details and customize the package
3Ô∏è‚É£ Final arrangements will be confirmed

‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
‚ÑπÔ∏è *IMPORTANT*
‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ‚îÅ
üìå Save this for your reference
üìå Contact us for any changes
üìå Cancellations: 48 hours notice

‚ïî‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïó
  Questions? We're here!
‚ïö‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïù

üìû +971563561803
üìß info@lyanrestaurant.com
üåê www.lyanrestaurant.com

_Thank you for choosing LYAN!_ ‚ù§Ô∏è
_We'll make your event unforgettable!_ ‚ú®`;

      setAutoResponseMessage(autoResponse);
      setSuccessPlatform('whatsapp');
      setSuccessDialogOpen(true);
      handleCloseDetails();
    }
  };

  useEffect(() => {
    const fetchPackages = async () => {
      try {
        const response = await packageAPI.getAll();
        const allPackages = response?.data || [];
        // Get one package from each category, up to 3-4
        const categories = [...new Set(allPackages.map(p => p.category))];
        const featured = categories.slice(0, 4).map(cat => allPackages.find(p => p.category === cat)).filter(Boolean);
        setFeaturedPackages(featured.length > 0 ? featured : allPackages.slice(0, 3));
      } catch (error) {
        console.error('Failed to fetch packages', error);
      }
    };
    fetchPackages();
  }, []);

  const handleViewPackage = (pkg) => {
    setSelectedPackage(pkg);
    setDetailsOpen(true);
  };

  const fadeIn = {
    hidden: { opacity: 0 },
    visible: { opacity: 1, transition: { duration: 0.9 } }
  };

  const slideUp = {
    hidden: { y: 50, opacity: 0 },
    visible: { y: 0, opacity: 1, transition: { duration: 0.7 } }
  };

  const prefersDarkMode = useMediaQuery('(prefers-color-scheme: dark)');

  return (
    <Box sx={{ bgcolor: '#f6f8fb' }}>
      <Box
        sx={{
          position: 'relative',
          minHeight: { xs: '75vh', md: '90vh' },
          display: 'flex',
          alignItems: 'center',
          color: 'white',
          backgroundImage: `linear-gradient(115deg, rgba(7,137,48,0.82) 0%, rgba(212,175,55,0.65) 45%, rgba(20,20,20,0.6) 100%), url(${heroImage})`,
          backgroundSize: 'cover',
          backgroundPosition: 'center',
          overflow: 'hidden'
        }}
      >
        <Box
          sx={{
            position: 'absolute',
            inset: 0,
            backgroundImage: 'radial-gradient(circle at 20% 20%, rgba(255,255,255,0.18), transparent 45%)'
          }}
        />
        <Container maxWidth="lg" sx={{ position: 'relative', zIndex: 1 }}>
          <Grid container spacing={6} alignItems="center">
            <Grid item xs={12} md={7}>
              <motion.div initial="hidden" animate="visible" variants={fadeIn}>
                <Chip
                  label="LYAN Catering & Events"
                  sx={{
                    mb: 3,
                    bgcolor: 'rgba(255,255,255,0.2)',
                    color: 'white',
                    fontWeight: 600,
                    letterSpacing: 1,
                    borderRadius: 999,
                    px: 2
                  }}
                />
                <Typography
                  variant="h2"
                  sx={{
                    fontWeight: 800,
                    lineHeight: 1.05,
                    fontSize: { xs: '2.5rem', md: '3.6rem' },
                    display: { xs: 'none', md: 'block' }
                  }}
                >
                  Celebrate boldly. We translate your story into unforgettable moments.
                </Typography>
                <Typography
                  variant="h3"
                  sx={{
                    fontWeight: 800,
                    lineHeight: 1.1,
                    fontSize: { xs: '2.1rem', sm: '2.4rem' },
                    display: { xs: 'block', md: 'none' }
                  }}
                >
                  Plan unforgettable events with LYAN Catering & Events.
                </Typography>
                <Typography
                  variant="h6"
                  sx={{ opacity: 0.92, mt: 2, maxWidth: 620, fontWeight: 400, display: { xs: 'none', md: 'block' } }}
                >
                  Trusted planners, designers, and culinary artists crafting elevated Ethiopian and
                  global celebrations for weddings, milestones, and corporate experiences.
                </Typography>
                <Typography
                  variant="body1"
                  sx={{
                    opacity: 0.92,
                    mt: 2,
                    maxWidth: 520,
                    fontWeight: 500,
                    display: { xs: 'block', md: 'none' }
                  }}
                >
                  Discover venues, menus, and full-service planners in one hub designed for weddings,
                  milestones, and corporate gatherings.
                </Typography>

                <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2.5} sx={{ mt: 4 }}>
                  <Button
                    component={Link}
                    to="/packages"
                    variant="contained"
                    size="large"
                    sx={{
                      px: 4,
                      py: 1.4,
                      borderRadius: 999,
                      fontWeight: 600,
                      background: 'linear-gradient(135deg, #FFFFFF 0%, #F6F6F6 100%)',
                      color: '#078930',
                      '&:hover': { background: 'linear-gradient(135deg, #F0F0F0 0%, #FFFFFF 100%)' }
                    }}
                  >
                    Browse signature packages
                  </Button>
                  <Button
                    component={Link}
                    to="/contact"
                    variant="outlined"
                    size="large"
                    sx={{
                      px: 4,
                      py: 1.4,
                      borderRadius: 999,
                      fontWeight: 600,
                      borderColor: 'rgba(255,255,255,0.7)',
                      color: 'white',
                      '&:hover': { borderColor: 'white', bgcolor: 'rgba(255,255,255,0.12)' }
                    }}
                  >
                    Plan with our experts
                  </Button>
                </Stack>
              </motion.div>
            </Grid>
            <Grid item xs={12} md={5}>
              <motion.div initial="hidden" animate="visible" variants={slideUp}>
                <Paper
                  elevation={0}
                  sx={{
                    bgcolor: 'rgba(255,255,255,0.15)',
                    borderRadius: 4,
                    p: 3,
                    backdropFilter: 'blur(10px)'
                  }}
                >
                  <Typography variant="subtitle2" sx={{ textTransform: 'uppercase', opacity: 0.8 }}>
                    By the numbers
                  </Typography>
                  <Stack direction="row" spacing={2} sx={{ mt: 2 }}>
                    {stats.map((stat) => (
                      <Box key={stat.label} sx={{ flex: 1 }}>
                        <Typography variant="h4" fontWeight={700}>
                          {stat.value}
                        </Typography>
                        <Typography variant="body2" sx={{ opacity: 0.75 }}>
                          {stat.label}
                        </Typography>
                      </Box>
                    ))}
                  </Stack>
                  <Divider sx={{ my: 3, borderColor: 'rgba(255,255,255,0.25)' }} />
                  <Stack spacing={1.5}>
                    <Stack direction="row" spacing={2} alignItems="center">
                      <Avatar sx={{ bgcolor: 'rgba(255,255,255,0.2)' }}>
                        <FavoriteIcon />
                      </Avatar>
                      <Typography variant="body2" sx={{ opacity: 0.85 }}>
                        Complete event architecture: culinary, design, entertainment, logistics, and
                        guest hospitality.
                      </Typography>
                    </Stack>
                    <Stack direction="row" spacing={2} alignItems="center">
                      <Avatar sx={{ bgcolor: 'rgba(255,255,255,0.2)' }}>
                        <VerifiedIcon />
                      </Avatar>
                      <Typography variant="body2" sx={{ opacity: 0.85 }}>
                        Dedicated producer for every celebration with 24/7 coordination support.
                      </Typography>
                    </Stack>
                  </Stack>
                </Paper>
              </motion.div>
            </Grid>
          </Grid>
        </Container>
      </Box>

      {/* Featured Packages Section */}
      <Container maxWidth="lg" sx={{ py: { xs: 8, md: 10 } }}>
        <motion.div initial="hidden" whileInView="visible" viewport={{ once: true }} variants={slideUp}>
          <Typography
            variant="overline"
            sx={{ display: 'block', textAlign: 'center', letterSpacing: 4, color: 'primary.main' }}
          >
            Curated Packages
          </Typography>
          <Typography
            variant="h3"
            textAlign="center"
            sx={{ fontWeight: 700, mt: 1, mb: 2 }}
          >
            Handpicked Experiences
          </Typography>
          <Typography
            variant="body1"
            color="text.secondary"
            textAlign="center"
            sx={{ maxWidth: 640, mx: 'auto', mb: 6 }}
          >
            Discover our most popular packages, designed to make your planning effortless.
          </Typography>

          <Grid container spacing={4}>
            {featuredPackages.map((pkg) => (
              <Grid item xs={12} md={4} key={pkg._id}>
                <Card
                  sx={{
                    height: '100%',
                    display: 'flex',
                    flexDirection: 'column',
                    borderRadius: 4,
                    overflow: 'hidden',
                    boxShadow: '0 10px 30px -10px rgba(0,0,0,0.1)',
                    transition: 'all 0.3s ease',
                    '&:hover': { transform: 'translateY(-5px)', boxShadow: '0 20px 40px -15px rgba(0,0,0,0.15)' }
                  }}
                >
                  <Box sx={{ position: 'relative', height: 200, bgcolor: 'grey.200' }}>
                    {/* Placeholder for package image if available, or a gradient */}
                    <Box
                      sx={{
                        width: '100%',
                        height: '100%',
                        background: 'linear-gradient(135deg, #078930 0%, #D4AF37 100%)',
                        display: 'flex',
                        alignItems: 'center',
                        justifyContent: 'center',
                        color: 'white'
                      }}
                    >
                      <CelebrationIcon sx={{ fontSize: 60, opacity: 0.5 }} />
                    </Box>
                    <Chip
                      label={pkg.category}
                      size="small"
                      sx={{
                        position: 'absolute',
                        top: 16,
                        right: 16,
                        bgcolor: 'white',
                        fontWeight: 700,
                        textTransform: 'capitalize'
                      }}
                    />
                  </Box>
                  <CardContent sx={{ flexGrow: 1 }}>
                    <Typography variant="h5" fontWeight={700} gutterBottom>
                      {pkg.name}
                    </Typography>
                    <Typography variant="h6" color="primary" fontWeight={700} gutterBottom>
                      {pkg.discountedPrice ? (
                        <>
                          {pkg.discountedPrice.toLocaleString()} ETB
                          <Typography
                            component="span"
                            variant="body2"
                            color="text.secondary"
                            sx={{ textDecoration: 'line-through', ml: 1 }}
                          >
                            {pkg.price.toLocaleString()} ETB
                          </Typography>
                        </>
                      ) : (
                        `${pkg.price.toLocaleString()} ETB`
                      )}
                    </Typography>
                    <Typography
                      variant="body2"
                      color="text.secondary"
                      sx={{
                        mb: 2,
                        display: '-webkit-box',
                        WebkitLineClamp: 3,
                        WebkitBoxOrient: 'vertical',
                        overflow: 'hidden'
                      }}
                    >
                      {pkg.description}
                    </Typography>
                    <Button
                      variant="outlined"
                      fullWidth
                      endIcon={<ArrowForwardIcon />}
                      onClick={() => handleViewPackage(pkg)}
                      sx={{ borderRadius: 2, mt: 'auto' }}
                    >
                      View Details
                    </Button>
                  </CardContent>
                </Card>
              </Grid>
            ))}
          </Grid>
          
          <Box textAlign="center" mt={6}>
            <Button
              component={Link}
              to="/packages"
              variant="contained"
              size="large"
              sx={{
                px: 5,
                py: 1.4,
                borderRadius: 999,
                background: 'linear-gradient(135deg, #078930 0%, #D4AF37 100%)',
                fontWeight: 600,
                '&:hover': { background: 'linear-gradient(135deg, #D4AF37 0%, #078930 100%)' }
              }}
            >
              View All Packages
            </Button>
          </Box>
        </motion.div>
      </Container>

      <Container maxWidth="lg" sx={{ py: { xs: 8, md: 10 } }}>
        <motion.div initial="hidden" whileInView="visible" viewport={{ once: true }} variants={slideUp}>
          <Typography
            variant="overline"
            sx={{
              display: 'block',
              textAlign: 'center',
              letterSpacing: 4,
              color: 'primary.main'
            }}
          >
            Signature experiences
          </Typography>
          <Typography
            variant="h3"
            textAlign="center"
            sx={{ fontWeight: 700, mt: 1, mb: 2 }}
          >
            Crafted celebrations for every milestone
          </Typography>
          <Typography
            variant="body1"
            color="text.secondary"
            textAlign="center"
            sx={{ maxWidth: 640, mx: 'auto', mb: 6 }}
          >
            Explore fully produced experiences designed to capture culture, story, and modern flair.
          </Typography>

          <Grid container spacing={4}>
            {signatureExperiences.map((experience) => (
              <Grid item xs={12} md={4} key={experience.title}>
                <motion.div whileHover={{ y: -8 }} transition={{ duration: 0.3 }}>
                  <Card
                    sx={{
                      height: '100%',
                      borderRadius: 4,
                      overflow: 'hidden',
                      position: 'relative',
                      boxShadow: '0 18px 45px -24px rgba(7,137,48,0.35)'
                    }}
                  >
                    <CardMedia
                      component="img"
                      image={experience.image}
                      srcSet={buildSrcSet(experience.image)}
                      sizes="(max-width: 600px) 100vw, (max-width: 1200px) 50vw, 33vw"
                      height="240"
                      alt={experience.title}
                      loading="lazy"
                      decoding="async"
                    />
                    <CardContent sx={{ minHeight: 220 }}>
                      <Chip
                        label="Featured"
                        size="small"
                        sx={{ bgcolor: experience.accent, fontWeight: 600, mb: 2 }}
                      />
                      <Typography variant="h5" fontWeight={700} gutterBottom>
                        {experience.title}
                      </Typography>
                      <Typography variant="body2" color="text.secondary">
                        {experience.description}
                      </Typography>
                    </CardContent>
                  </Card>
                </motion.div>
              </Grid>
            ))}
          </Grid>

          <Box textAlign="center" mt={6}>
            <Button
              component={Link}
              to="/packages"
              variant="contained"
              size="large"
              sx={{
                px: 5,
                py: 1.4,
                borderRadius: 999,
                background: 'linear-gradient(135deg, #078930 0%, #D4AF37 100%)',
                fontWeight: 600,
                '&:hover': { background: 'linear-gradient(135deg, #D4AF37 0%, #078930 100%)' }
              }}
            >
              View the full package catalog
            </Button>
          </Box>
        </motion.div>
      </Container>

      {/* Venue Partners Section */}
      <Box sx={{ bgcolor: '#f9fafb', py: { xs: 8, md: 10 } }}>
        <Container maxWidth="lg">
          <motion.div initial="hidden" whileInView="visible" viewport={{ once: true }} variants={slideUp}>
            <Typography
              variant="overline"
              sx={{ display: 'block', textAlign: 'center', letterSpacing: 4, color: 'primary.main' }}
            >
              Our Venue Partners
            </Typography>
            <Typography
              variant="h3"
              textAlign="center"
              sx={{ fontWeight: 700, mt: 1, mb: 2 }}
            >
              Exclusive Locations for Your Event
            </Typography>
            <Typography
              variant="body1"
              color="text.secondary"
              textAlign="center"
              sx={{ maxWidth: 640, mx: 'auto', mb: 6 }}
            >
              We partner with the finest venues in Addis Ababa to provide the perfect backdrop for your celebration.
            </Typography>

            <Grid container spacing={4}>
              {venuePartners.map((venue) => (
                <Grid item xs={12} sm={6} md={4} key={venue.id}>
                  <Card
                    sx={{
                      height: '100%',
                      borderRadius: 4,
                      overflow: 'hidden',
                      boxShadow: '0 10px 30px -10px rgba(0,0,0,0.1)',
                      transition: 'transform 0.3s ease',
                      '&:hover': { transform: 'translateY(-8px)' }
                    }}
                  >
                    <CardMedia
                      component="img"
                      height="220"
                      image={venue.image}
                      alt={venue.name}
                    />
                    <CardContent>
                      <Typography variant="h6" fontWeight={700} gutterBottom>
                        {venue.name}
                      </Typography>
                      <Stack direction="row" spacing={1} alignItems="center" mb={1}>
                        <LocationOnIcon fontSize="small" color="action" />
                        <Typography variant="body2" color="text.secondary">
                          {venue.location}
                        </Typography>
                      </Stack>
                      <Typography variant="body2" color="text.secondary" sx={{ mb: 2 }}>
                        {venue.description}
                      </Typography>
                    </CardContent>
                  </Card>
                </Grid>
              ))}
            </Grid>
          </motion.div>
        </Container>
      </Box>

      <Box sx={{ bgcolor: '#ffffff', py: { xs: 8, md: 10 } }}>
        <Container maxWidth="lg">
          <motion.div initial="hidden" whileInView="visible" variants={fadeIn} viewport={{ once: true }}>
            <Typography
              variant="overline"
              sx={{ display: 'block', textAlign: 'center', letterSpacing: 4, color: 'primary.main' }}
            >
              Trusted collaborations
            </Typography>
            <Typography variant="h3" textAlign="center" sx={{ fontWeight: 700, mt: 1, mb: 6 }}>
              Partnering with excellence
            </Typography>
            <Grid container spacing={4} justifyContent="center" alignItems="center">
              {partnerLogos.map((partner) => (
                <Grid item xs={6} sm={4} md={2} key={partner.name}>
                  <Box
                    component="img"
                    src={prefersDarkMode ? partner.darkLogo : partner.lightLogo}
                    alt={partner.name}
                    sx={{
                      width: '100%',
                      height: 'auto',
                      maxHeight: 60,
                      objectFit: 'contain',
                      filter: 'grayscale(100%)',
                      opacity: 0.6,
                      transition: 'all 0.3s ease',
                      '&:hover': {
                        filter: 'grayscale(0%)',
                        opacity: 1,
                        transform: 'scale(1.05)'
                      }
                    }}
                  />
                </Grid>
              ))}
            </Grid>
          </motion.div>
        </Container>
      </Box>

      <Box sx={{ bgcolor: '#f6f8fb', py: { xs: 8, md: 10 } }}>
        <Container maxWidth="lg">
          <motion.div initial="hidden" whileInView="visible" viewport={{ once: true }} variants={fadeIn}>
            <Grid container spacing={4} alignItems="center">
              <Grid item xs={12} md={5}>
                <Typography variant="overline" sx={{ letterSpacing: 4, color: 'primary.main' }}>
                  Why partner with us
                </Typography>
                <Typography variant="h3" sx={{ fontWeight: 700, mt: 1, mb: 2 }}>
                  Elevated services at every touchpoint
                </Typography>
                <Typography variant="body1" color="text.secondary" sx={{ mb: 4 }}>
                  A multidisciplinary team delivering immersive hospitality, on-time logistics, and
                  design excellence anchored in Ethiopian warmth.
                </Typography>
                <Stack spacing={2.5}>
                  {serviceHighlights.map((item) => (
                    <Paper
                      key={item.title}
                      elevation={0}
                      sx={{
                        p: 3,
                        borderRadius: 3,
                        border: `1px solid ${item.color}22`
                      }}
                    >
                      <Stack direction="row" spacing={2} alignItems="flex-start">
                        <Avatar sx={{ bgcolor: `${item.color}1A`, color: item.color }}>
                          {item.icon}
                        </Avatar>
                        <Box>
                          <Typography variant="h6" fontWeight={700}>
                            {item.title}
                          </Typography>
                          <Typography variant="body2" color="text.secondary">
                            {item.description}
                          </Typography>
                        </Box>
                      </Stack>
                    </Paper>
                  ))}
                </Stack>
              </Grid>
              <Grid item xs={12} md={7}>
                <Paper
                  elevation={0}
                  sx={{
                    p: { xs: 3, md: 5 },
                    borderRadius: 4,
                    background: 'linear-gradient(135deg, rgba(7,137,48,0.08) 0%, rgba(212,175,55,0.12) 100%)'
                  }}
                >
                  <Typography variant="subtitle2" sx={{ textTransform: 'uppercase', color: 'primary.main' }}>
                    Your journey with us
                  </Typography>
                  <Stack spacing={3} sx={{ mt: 3 }}>
                    {journeySteps.map((step, index) => (
                      <Stack key={step.title} direction="row" spacing={3} alignItems="flex-start">
                        <Box
                          sx={{
                            width: 44,
                            height: 44,
                            borderRadius: '50%',
                            bgcolor: '#078930',
                            color: 'white',
                            display: 'flex',
                            alignItems: 'center',
                            justifyContent: 'center',
                            fontWeight: 700,
                            fontSize: 18
                          }}
                        >
                          {index + 1}
                        </Box>
                        <Box>
                          <Typography variant="subtitle1" fontWeight={700}>
                            {step.title}
                          </Typography>
                          <Typography variant="body2" fontWeight={600} sx={{ mb: 0.5 }}>
                            {step.subtitle}
                          </Typography>
                          <Typography variant="body2" color="text.secondary">
                            {step.description}
                          </Typography>
                        </Box>
                      </Stack>
                    ))}
                  </Stack>
                </Paper>
              </Grid>
            </Grid>
          </motion.div>
        </Container>
      </Box>

      <Container maxWidth="lg" sx={{ py: { xs: 8, md: 10 } }}>
        <motion.div initial="hidden" whileInView="visible" viewport={{ once: true }} variants={slideUp}>
          <Typography
            variant="overline"
            sx={{ textAlign: 'center', letterSpacing: 4, color: 'primary.main' }}
          >
            Stories from our clients
          </Typography>
          <Typography
            variant="h3"
            textAlign="center"
            sx={{ fontWeight: 700, mt: 1, mb: 2 }}
          >
            Celebrations that become cherished memories
          </Typography>
          <Typography
            variant="body1"
            color="text.secondary"
            textAlign="center"
            sx={{ maxWidth: 620, mx: 'auto', mb: 6 }}
          >
            Hear from couples, executives, and families who trusted LYAN with their milestone moments.
          </Typography>

          <Grid container spacing={4}>
            {testimonials.map((testimonial) => (
              <Grid item xs={12} md={4} key={testimonial.name}>
                <Paper elevation={0} sx={{ p: 3, borderRadius: 4, bgcolor: '#ffffff' }}>
                  <Stack spacing={2}>
                    <Stack direction="row" spacing={2} alignItems="center">
                      <Avatar src={testimonial.avatar} alt={testimonial.name} />
                      <Box>
                        <Typography variant="subtitle1" fontWeight={700}>
                          {testimonial.name}
                        </Typography>
                        <Typography variant="caption" color="text.secondary">
                          {testimonial.title}
                        </Typography>
                      </Box>
                    </Stack>
                    <Typography variant="body2" color="text.secondary">
                      ‚Äú{testimonial.quote}‚Äù
                    </Typography>
                  </Stack>
                </Paper>
              </Grid>
            ))}
          </Grid>
        </motion.div>
      </Container>



      <Box sx={{ py: { xs: 9, md: 11 }, background: 'linear-gradient(135deg, rgba(212,175,55,0.32) 0%, rgba(7,137,48,0.3) 100%)' }}>
        <Container maxWidth="md">
          <motion.div initial="hidden" whileInView="visible" variants={slideUp} viewport={{ once: true }}>
            <Typography
              variant="h3"
              textAlign="center"
              sx={{ fontWeight: 700, mb: 2 }}
            >
              Ready to bring your celebration to life?
            </Typography>
            <Typography
              variant="body1"
              color="text.secondary"
              textAlign="center"
              sx={{ maxWidth: 520, mx: 'auto', mb: 4 }}
            >
              Schedule a design consultation or chat with our planners to begin crafting a bespoke
              experience tailored to you.
            </Typography>
            <Stack direction={{ xs: 'column', sm: 'row' }} spacing={2} justifyContent="center">
              <Button
                variant="contained"
                size="large"
                component={Link}
                to="/booking"
                sx={{
                  borderRadius: 999,
                  px: 4,
                  py: 1.4,
                  fontWeight: 600,
                  backgroundColor: '#078930',
                  '&:hover': { backgroundColor: '#056624' }
                }}
              >
                Book a Consultation
              </Button>
              <Button
                variant="outlined"
                size="large"
                onClick={() => window.open('https://wa.me/+971563561803', '_blank')}
                sx={{
                  borderRadius: 999,
                  px: 4,
                  py: 1.4,
                  fontWeight: 600,
                  borderColor: '#078930',
                  color: '#078930',
                  '&:hover': { borderColor: '#056624', color: '#056624' }
                }}
              >
                Chat on WhatsApp
              </Button>
            </Stack>
          </motion.div>
        </Container>
      </Box>

      {/* Quick Connect Section for Non-Tech Users */}
      <Box sx={{ bgcolor: 'white', py: 6, borderBottom: '1px solid rgba(0,0,0,0.05)' }}>
        <Container maxWidth="md">
          <Stack direction={{ xs: 'column', md: 'row' }} alignItems="center" justifyContent="space-between" spacing={3}>
            <Box>
              <Typography variant="h5" fontWeight={700} gutterBottom>
                Prefer to chat directly?
              </Typography>
              <Typography variant="body1" color="text.secondary">
                Skip the forms. Talk to our planners instantly on your favorite app.
              </Typography>
            </Box>
            <Stack direction="row" spacing={2}>
              <Button
                variant="contained"
                size="large"
                startIcon={<WhatsAppIcon />}
                onClick={() => window.open('https://wa.me/+971563561803', '_blank')}
                sx={{
                  bgcolor: '#25D366',
                  '&:hover': { bgcolor: '#128C7E' },
                  borderRadius: 999,
                  px: 3,
                  fontWeight: 600
                }}
              >
                WhatsApp
              </Button>
              <Button
                variant="contained"
                size="large"
                startIcon={<TelegramIcon />}
                onClick={() => window.open('https://t.me/LyanEventsBot', '_blank')}
                sx={{
                  bgcolor: '#0088cc',
                  '&:hover': { bgcolor: '#0077b5' },
                  borderRadius: 999,
                  px: 3,
                  fontWeight: 600
                }}
              >
                Telegram
              </Button>
            </Stack>
          </Stack>
        </Container>
      </Box>

      {/* Package Details Dialog */}
      <Dialog
        open={detailsOpen}
        onClose={handleCloseDetails}
        fullScreen
        TransitionComponent={Transition}
        PaperProps={dialogPaperProps}
      >
        {selectedPackage && (
          <Box sx={{ height: '100vh', overflowY: 'auto', display: 'flex', flexDirection: 'column' }}>
            {/* Header */}
            <Box sx={{ 
              position: 'sticky', 
              top: 0, 
              zIndex: 10, 
              bgcolor: 'white', 
              borderBottom: 1, 
              borderColor: 'divider',
              px: { xs: 2, md: 4 },
              py: 2,
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'space-between'
            }}>
              <Stack direction="row" alignItems="center" spacing={2}>
                <IconButton onClick={handleCloseDetails} edge="start">
                  <CloseIcon />
                </IconButton>
                <Typography variant="h6" fontWeight={700} noWrap>
                  Package Details
                </Typography>
              </Stack>
            </Box>

            {/* Content */}
            <Container maxWidth="lg" sx={{ py: 4 }}>
              <Grid container spacing={4}>
                {/* Left Column: Details */}
                <Grid item xs={12} md={7}>
                  <Paper elevation={0} sx={{ borderRadius: 4, overflow: 'hidden', mb: 4 }}>
                    <Box sx={{ 
                      height: { xs: 250, md: 400 }, 
                      bgcolor: 'grey.200',
                      display: 'flex',
                      alignItems: 'center',
                      justifyContent: 'center',
                      background: 'linear-gradient(135deg, #078930 0%, #D4AF37 100%)',
                      color: 'white',
                      position: 'relative'
                    }}>
                      {selectedPackage.image ? (
                        <Box 
                          component="img" 
                          src={selectedPackage.image} 
                          alt={selectedPackage.name}
                          sx={{ width: '100%', height: '100%', objectFit: 'cover' }}
                        />
                      ) : (
                        <CelebrationIcon sx={{ fontSize: 80, opacity: 0.5 }} />
                      )}
                    </Box>
                  </Paper>

                  <Stack direction="row" spacing={1} sx={{ mb: 2 }}>
                    <Chip 
                      label={selectedPackage.category} 
                      size="small" 
                      sx={{ 
                        textTransform: 'capitalize', 
                        fontWeight: 600, 
                        bgcolor: alpha('#078930', 0.1), 
                        color: '#078930' 
                      }} 
                    />
                    {selectedPackage.maxGuests && (
                      <Chip 
                        label={`Up to ${selectedPackage.maxGuests} guests`} 
                        size="small" 
                        sx={{ 
                          fontWeight: 600, 
                          bgcolor: alpha('#000', 0.05) 
                        }} 
                      />
                    )}
                  </Stack>

                  <Typography variant="h3" fontWeight={800} gutterBottom>
                    {selectedPackage.name}
                  </Typography>
                  <Typography variant="h6" color="text.secondary" sx={{ mb: 4, fontWeight: 400, lineHeight: 1.6 }}>
                    {selectedPackage.description}
                  </Typography>

                  {selectedPackage.features && selectedPackage.features.length > 0 && (
                    <Box>
                      <Typography variant="h5" fontWeight={700} gutterBottom sx={{ mb: 3 }}>
                        What&apos;s Included
                      </Typography>
                      <Grid container spacing={2}>
                        {selectedPackage.features.map((feature, index) => (
                          <Grid item xs={12} sm={6} key={index}>
                            <Paper 
                              elevation={0} 
                              sx={{ 
                                p: 2, 
                                borderRadius: 2, 
                                bgcolor: 'white',
                                border: '1px solid',
                                borderColor: 'divider',
                                display: 'flex',
                                alignItems: 'flex-start',
                                gap: 2
                              }}
                            >
                              <VerifiedIcon color="success" sx={{ mt: 0.5 }} />
                              <Typography variant="body1" fontWeight={500}>
                                {feature}
                              </Typography>
                            </Paper>
                          </Grid>
                        ))}
                      </Grid>
                    </Box>
                  )}

                  <Box sx={{ mt: 6, p: 3, bgcolor: alpha('#000', 0.02), borderRadius: 4 }}>
                    <Typography variant="h6" fontWeight={700} gutterBottom>
                      Why Choose Lyan?
                    </Typography>
                    <Grid container spacing={3} sx={{ mt: 0 }}>
                      <Grid item xs={12} sm={6}>
                        <Stack direction="row" spacing={2} alignItems="flex-start">
                          <Avatar sx={{ bgcolor: alpha('#078930', 0.1), color: '#078930' }}>
                            <RestaurantIcon fontSize="small" />
                          </Avatar>
                          <Box>
                            <Typography variant="subtitle2" fontWeight={700}>Authentic Cuisine</Typography>
                            <Typography variant="body2" color="text.secondary" sx={{ fontSize: '0.85rem' }}>
                              Traditional flavors with modern presentation.
                            </Typography>
                          </Box>
                        </Stack>
                      </Grid>
                      <Grid item xs={12} sm={6}>
                        <Stack direction="row" spacing={2} alignItems="flex-start">
                          <Avatar sx={{ bgcolor: alpha('#D4AF37', 0.1), color: '#D4AF37' }}>
                            <CelebrationIcon fontSize="small" />
                          </Avatar>
                          <Box>
                            <Typography variant="subtitle2" fontWeight={700}>Premium Service</Typography>
                            <Typography variant="body2" color="text.secondary" sx={{ fontSize: '0.85rem' }}>
                              Dedicated team for a seamless experience.
                            </Typography>
                          </Box>
                        </Stack>
                      </Grid>
                    </Grid>
                  </Box>
                </Grid>

                {/* Right Column: Booking Form */}
                <Grid item xs={12} md={5}>
                  <Box>
                    {/* Price Card */}
                    <Paper elevation={0} sx={{ p: 3, borderRadius: 4, mb: 3, bgcolor: '#f0f7f2', border: '1px solid #078930' }}>
                      <Typography variant="subtitle2" color="text.secondary" gutterBottom>
                        INVESTMENT
                      </Typography>
                      <Typography variant="h3" color="primary.main" fontWeight={800} gutterBottom>
                        {selectedPackage.discountedPrice 
                          ? selectedPackage.discountedPrice.toLocaleString() 
                          : selectedPackage.price.toLocaleString()} ETB
                      </Typography>
                      {selectedPackage.discountedPrice && (
                        <Typography variant="h6" color="text.secondary" sx={{ textDecoration: 'line-through', mb: 2 }}>
                          {selectedPackage.price.toLocaleString()} ETB
                        </Typography>
                      )}
                      <Divider sx={{ my: 2, borderColor: 'rgba(7,137,48,0.2)' }} />
                      <Stack spacing={1}>
                        <Stack direction="row" justifyContent="space-between">
                          <Typography color="text.secondary">Category</Typography>
                          <Chip label={selectedPackage.category} size="small" sx={{ textTransform: 'capitalize', fontWeight: 600, bgcolor: 'white' }} />
                        </Stack>
                        {selectedPackage.maxGuests && (
                          <Stack direction="row" justifyContent="space-between">
                            <Typography color="text.secondary">Capacity</Typography>
                            <Typography fontWeight={600}>Up to {selectedPackage.maxGuests} guests</Typography>
                          </Stack>
                        )}
                      </Stack>
                    </Paper>

                    {/* Booking Form */}
                    <Paper elevation={3} sx={{ p: 3, borderRadius: 4 }}>
                      <Typography variant="h5" fontWeight={700} gutterBottom>
                        Book This Package
                      </Typography>
                      <Typography variant="body2" color="text.secondary" sx={{ mb: 3 }}>
                        Fill out the form below to request a booking. We&apos;ll confirm availability shortly.
                      </Typography>
                      
                      <form onSubmit={(e) => e.preventDefault()}>
                        <Stack spacing={2}>
                          <TextField
                            label="Full Name"
                            name="name"
                            value={bookingData.name}
                            onChange={handleBookingChange}
                            required
                            fullWidth
                            variant="outlined"
                          />
                          <TextField
                            label="Phone Number"
                            name="phoneNumber"
                            value={bookingData.phoneNumber}
                            onChange={handleBookingChange}
                            required
                            fullWidth
                            variant="outlined"
                            placeholder="+251 9..."
                            InputLabelProps={shrinkLabel}
                          />
                          <TextField
                            label="Event Date"
                            name="eventDate"
                            type="date"
                            value={bookingData.eventDate}
                            onChange={handleBookingChange}
                            required
                            fullWidth
                            InputLabelProps={shrinkLabel}
                            variant="outlined"
                          />
                          <Stack direction="row" spacing={2}>
                            <TextField
                              label="Guests"
                              name="guests"
                              type="number"
                              value={bookingData.guests}
                              onChange={handleBookingChange}
                              fullWidth
                              variant="outlined"
                            />
                            <TextField
                              label="Location"
                              name="location"
                              value={bookingData.location}
                              onChange={handleBookingChange}
                              fullWidth
                              variant="outlined"
                            />
                          </Stack>
                          <TextField
                            label="Special Requests / Notes"
                            name="notes"
                            value={bookingData.notes}
                            onChange={handleBookingChange}
                            multiline
                            rows={3}
                            fullWidth
                            variant="outlined"
                          />
                          
                          <Stack spacing={2} sx={{ mt: 2 }}>
                            <Button
                              type="button"
                              variant="contained"
                              size="large"
                              onClick={handleSendWhatsApp}
                              startIcon={<WhatsAppIcon />}
                              fullWidth
                              sx={{
                                bgcolor: '#25D366',
                                '&:hover': { bgcolor: '#128C7E' },
                                py: 1.5,
                                fontWeight: 700
                              }}
                            >
                              Book via WhatsApp
                            </Button>
                            <Button
                              type="button"
                              variant="contained"
                              size="large"
                              onClick={handleSendTelegram}
                              startIcon={<TelegramIcon />}
                              fullWidth
                              sx={{
                                bgcolor: '#0088cc',
                                '&:hover': { bgcolor: '#0077b5' },
                                py: 1.5,
                                fontWeight: 700
                              }}
                            >
                              Book via Telegram
                            </Button>
                          </Stack>
                        </Stack>
                      </form>
                    </Paper>
                  </Box>
                </Grid>
              </Grid>
            </Container>
          </Box>
        )}
      </Dialog>

      {/* Success Dialog */}
      <Dialog
        open={successDialogOpen}
        onClose={() => setSuccessDialogOpen(false)}
        maxWidth="sm"
        fullWidth
        PaperProps={{
          sx: {
            borderRadius: 4,
            textAlign: 'center',
            p: 2
          }
        }}
      >
        <DialogContent sx={{ pt: 4, pb: 2 }}>
          <Box
            sx={{
              width: 80,
              height: 80,
              borderRadius: '50%',
              bgcolor: successPlatform === 'whatsapp' ? alpha('#25D366', 0.1) : alpha('#0088cc', 0.1),
              color: successPlatform === 'whatsapp' ? '#25D366' : '#0088cc',
              display: 'flex',
              alignItems: 'center',
              justifyContent: 'center',
              mx: 'auto',
              mb: 3
            }}
          >
            {successPlatform === 'whatsapp' ? (
              <WhatsAppIcon sx={{ fontSize: 40 }} />
            ) : (
              <TelegramIcon sx={{ fontSize: 40 }} />
            )}
          </Box>
          
          <Typography variant="h5" fontWeight={800} gutterBottom>
            {successPlatform === 'whatsapp' ? 'Inquiry Sent Successfully!' : 'Connect on Telegram'}
          </Typography>
          
          <Typography variant="body1" color="text.secondary" sx={{ mb: 3 }}>
            {successPlatform === 'whatsapp' 
              ? "We've opened WhatsApp for you to send your inquiry. Would you like to receive an automatic confirmation message with your booking details for your records?"
              : "Your inquiry has been received! Click the button below to open Telegram and view your package details."
            }
          </Typography>

          <Stack spacing={2}>
            {successPlatform === 'whatsapp' ? (
              <>
                <Button
                  variant="contained"
                  size="large"
                  onClick={() => {
                    const encodedAutoResponse = encodeURIComponent(autoResponseMessage);
                    window.open(`https://wa.me/?text=${encodedAutoResponse}`, '_blank');
                    toast.info('Confirmation message opened!');
                    setSuccessDialogOpen(false);
                  }}
                  sx={{
                    py: 1.5,
                    bgcolor: '#25D366',
                    borderRadius: 2,
                    fontWeight: 700,
                    '&:hover': { bgcolor: '#128C7E' }
                  }}
                >
                  Yes, Send Me Confirmation
                </Button>
                
                <Button
                  variant="outlined"
                  size="large"
                  onClick={() => setSuccessDialogOpen(false)}
                  sx={{
                    py: 1.5,
                    borderRadius: 2,
                    fontWeight: 600,
                    color: 'text.secondary',
                    borderColor: 'divider'
                  }}
                >
                  No, I&apos;m Good
                </Button>
              </>
            ) : (
              <>
                <Button
                  variant="contained"
                  size="large"
                  href={telegramLink}
                  target="_blank"
                  rel="noopener noreferrer"
                  onClick={() => setSuccessDialogOpen(false)}
                  sx={{
                    py: 1.5,
                    bgcolor: '#0088cc',
                    borderRadius: 2,
                    fontWeight: 700,
                    '&:hover': { bgcolor: '#006699' }
                  }}
                >
                  Open Telegram
                </Button>
                
                <Button
                  variant="outlined"
                  size="large"
                  onClick={() => setSuccessDialogOpen(false)}
                  sx={{
                    py: 1.5,
                    borderRadius: 2,
                    fontWeight: 600,
                    color: 'text.secondary',
                    borderColor: 'divider'
                  }}
                >
                  Close
                </Button>
              </>
            )}
          </Stack>
        </DialogContent>
      </Dialog>
    </Box>
  );
};

export default Home;
